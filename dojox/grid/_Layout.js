//>>built
define("dojox/grid/_Layout","dojo/_base/kernel ../main dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/dom-geometry ./cells ./_RowSelector".split(" "),function(r,m,p,n,h,q){return p("dojox.grid._Layout",null,{constructor:function(a){this.grid=a},cells:[],structure:null,defaultWidth:"6em",moveColumn:function(a,c,b,d,g){var e=this.structure[a].cells[0],l=this.structure[c].cells[0],f=null,h=f=0;a=0;for(var k;k=e[a];a++)if(k.index==b){f=a;break}f=e.splice(f,1)[0];f.view=this.grid.views.views[c];
a=0;for(k=null;k=l[a];a++)if(k.index==d){h=a;break}g||(h+=1);l.splice(h,0,f);if(b=this.grid.getCell(this.grid.getSortIndex()))b._currentlySorted=this.grid.getSortAsc();this.cells=[];for(a=b=0;c=this.structure[a];a++)for(d=0;g=c.cells[d];d++)for(e=0;k=g[e];e++)k.index=b,this.cells.push(k),"_currentlySorted"in k&&(l=b+1,l*=k._currentlySorted?1:-1,this.grid.sortInfo=l,delete k._currentlySorted),b++;n.forEach(this.cells,function(a){var b=a.markup[2].split(" ");parseInt(b[1].substring(5))!=a.index&&(b[1]=
'idx\x3d"'+a.index+'"',a.markup[2]=b.join(" "))});this.grid.setupHeaderMenu()},setColumnVisibility:function(a,c){var b=this.cells[a];if(b.hidden==c){b.hidden=!c;var d=b.view,g=d.viewWidth;g&&"auto"!=g&&(d._togglingColumn=q.getMarginBox(b.getHeaderNode()).w||0);d.update();return!0}return!1},addCellDef:function(a,c,b){var d=this,g=function(a){var b=0;1<a.colSpan?b=0:(b=a.width||d._defaultCellProps.width||d.defaultWidth,isNaN(b)||(b+="em"));return b};a={grid:this.grid,subrow:a,layoutIndex:c,index:this.cells.length};
if(b&&b instanceof m.grid.cells._Base)return c=h.clone(b),a.unitWidth=g(c._props),c=h.mixin(c,this._defaultCellProps,b._props,a);c=b.type||b.cellType||this._defaultCellProps.type||this._defaultCellProps.cellType||m.grid.cells.Cell;h.isString(c)&&(c=h.getObject(c));a.unitWidth=g(b);return new c(h.mixin({},this._defaultCellProps,b,a))},addRowDef:function(a,c){for(var b=[],d=0,g=0,e=!0,l=0,f;f=c[l];l++)f=this.addCellDef(a,l,f),b.push(f),this.cells.push(f),e&&f.relWidth?d+=f.relWidth:f.width&&(f=f.width,
"string"==typeof f&&"%"==f.slice(-1)?g+=window.parseInt(f,10):"auto"==f&&(e=!1));d&&e&&n.forEach(b,function(a){a.relWidth&&(a.width=a.unitWidth=a.relWidth/d*(100-g)+"%")});return b},addRowsDef:function(a){var c=[];if(h.isArray(a))if(h.isArray(a[0]))for(var b=0,d;a&&(d=a[b]);b++)c.push(this.addRowDef(b,d));else c.push(this.addRowDef(0,a));return c},addViewDef:function(a){this._defaultCellProps=a.defaultCell||{};a.width&&"auto"==a.width&&delete a.width;return h.mixin({},a,{cells:this.addRowsDef(a.rows||
a.cells)})},setStructure:function(a){this.fieldIndex=0;this.cells=[];var c=this.structure=[];if(this.grid.rowSelector){var b={type:m._scopeName+".grid._RowSelector"};if(h.isString(this.grid.rowSelector)){var d=this.grid.rowSelector;"false"==d?b=null:"true"!=d&&(b.width=d)}else this.grid.rowSelector||(b=null);b&&c.push(this.addViewDef(b))}b=function(a){return null!==a&&h.isObject(a)&&("cells"in a||"rows"in a||"type"in a&&!("name"in a||"field"in a||"get"in a))};if(h.isArray(a)){for(var d=!1,g=0,e;e=
a[g];g++)if(b(e)){d=!0;break}if(d)for(g=0;e=a[g];g++)h.isArray(e)&&(h.isArray(e[0])||"name"in e[0]||"field"in e[0]||"get"in e[0])?c.push(this.addViewDef({cells:e})):b(e)&&c.push(this.addViewDef(e));else c.push(this.addViewDef({cells:a}))}else b(a)&&c.push(this.addViewDef(a));this.cellCount=this.cells.length;this.grid.setupHeaderMenu()}})});
//@ sourceMappingURL=_Layout.js.map