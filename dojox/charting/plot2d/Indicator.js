//>>built
define("dojox/charting/plot2d/Indicator","dojo/_base/lang dojo/_base/array dojo/_base/declare ./CartesianBase ./_PlotEvents ./common ../axis2d/common dojox/gfx dojox/lang/utils dojox/gfx/fx dojo/has".split(" "),function(u,F,y,H,I,t,J,s,C,K,G){var L=function(b,c){var d=b.declaredClass,a;if(-1!=d.indexOf("svg"))try{return u.mixin({},b.rawNode.getBBox())}catch(e){}else{if(-1!=d.indexOf("vml")){var f=b.rawNode,t=f.style.display;f.style.display="inline";d=s.pt2px(parseFloat(f.currentStyle.width));a=s.pt2px(parseFloat(f.currentStyle.height));
d={x:0,y:0,width:d,height:a};z(b,d);f.style.display=t;return d}if(-1!=d.indexOf("silverlight"))return z(b,{width:b.rawNode.actualWidth,height:b.rawNode.actualHeight},0.75);if(b.getTextWidth)return d=b.getTextWidth(),f=b.getFont(),a=s.normalizedLength(f?f.size:s.defaultFont.size),d={width:d,height:a},z(b,d,0.75),d}return null},z=function(b,c,d){var a=c.width,e=c.height;b=b.getShape();switch(b.align){case "end":c.x=b.x-a;break;case "middle":c.x=b.x-a/2;break;default:c.x=b.x}c.y=b.y-e*(d||1);return c};
y=y("dojox.charting.plot2d.Indicator",[H,I],{defaultParams:{vertical:!0,fixed:!0,precision:0,lines:!0,labels:"line",markers:!0},optionalParams:{lineStroke:{},outlineStroke:{},shadowStroke:{},lineFill:{},stroke:{},outline:{},shadow:{},fill:{},fillFunc:null,labelFunc:null,font:"",fontColor:"",markerStroke:{},markerOutline:{},markerShadow:{},markerFill:{},markerSymbol:"",values:[],offset:{},start:!1,animate:!1},constructor:function(b,c){this.opt=u.clone(this.defaultParams);C.updateWithObject(this.opt,
c);"number"==typeof c.values&&(c.values=[c.values]);C.updateWithPattern(this.opt,c,this.optionalParams);this.animate=this.opt.animate},render:function(b,c){if(this.zoom)return this.performZoom(b,c);if(!this.isDirty())return this;this.cleanGroup(null,!0);if(!this.opt.values)return this;this._updateIndicator();return this},_updateIndicator:function(){var b=this.chart.theme,c=this._hAxis.name,d=this._vAxis.name,a=this._hAxis.getScaler().bounds,e=this._vAxis.getScaler().bounds,f={};f[c]=a.from;f[d]=e.from;
var u=this.toPage(f);f[c]=a.to;f[d]=e.to;var D=this.toPage(f),l=this.events(),a=F.map(this.opt.values,function(a,b){return this._renderIndicator(a,b,c,d,u,D,l,this.animate)},this),e=a.length;if("trend"==this.opt.labels){var f=this.opt.vertical,h=this._data[0][0],k=this._data[e-1][0]-h,h=this.opt.labelFunc?this.opt.labelFunc(-1,this.values,this._data,this.opt.fixed,this.opt.precision):t.getLabel(k,this.opt.fixed,this.opt.precision)+" ("+t.getLabel(100*k/h,!0,2)+"%)";this._renderText(this.getGroup(),
h,this.chart.theme,f?(a[0].x+a[e-1].x)/2:a[1].x,f?a[0].y:(a[1].y+a[e-1].y)/2,-1,this.opt.values,this._data)}if((b=void 0!=this.opt.lineFill?this.opt.lineFill:b.indicator.lineFill)&&1<e)f=Math.min(a[0].x1,a[e-1].x1),h=Math.min(a[0].y1,a[e-1].y1),this.getGroup().createRect({x:f,y:h,width:Math.max(a[0].x2,a[e-1].x2)-f,height:Math.max(a[0].y2,a[e-1].y2)-h}).setFill(b).moveToBack()},_renderIndicator:function(b,c,d,a,e,f,y,D){var l=this.chart.theme,h=this.chart.getCoords(),k=this.opt.vertical,v=this.getGroup().createGroup(),
g={};g[d]=k?b:0;g[a]=k?0:b;G("dojo-bidi")&&(g.x=this._getMarkX(g.x));var g=this.toPage(g),q=k?g.x>=e.x&&g.x<=f.x:g.y>=f.y&&g.y<=e.y,s=g.x-h.x,E=g.y-h.y,m=k?s:e.x-h.x,n=k?e.y-h.y:E,A=k?m:f.x-h.x,w=k?f.y-h.y:n;if(this.opt.lines&&q){var r=this.opt.hasOwnProperty("lineShadow")?this.opt.lineShadow:l.indicator.lineShadow,x=this.opt.hasOwnProperty("lineStroke")?this.opt.lineStroke:l.indicator.lineStroke,p=this.opt.hasOwnProperty("lineOutline")?this.opt.lineOutline:l.indicator.lineOutline;r&&v.createLine({x1:m+
r.dx,y1:n+r.dy,x2:A+r.dx,y2:w+r.dy}).setStroke(r);p&&(p=t.makeStroke(p),p.width=2*p.width+(x?x.width:0),v.createLine({x1:m,y1:n,x2:A,y2:w}).setStroke(p));v.createLine({x1:m,y1:n,x2:A,y2:w}).setStroke(x)}var z;if(this.opt.markers&&q){var B=this._data[c],C=this;B&&(z=F.map(B,function(c,q){g[d]=k?b:c;g[a]=k?c:b;G("dojo-bidi")&&(g.x=C._getMarkX(g.x));g=this.toPage(g);if(k?g.y<=e.y&&g.y>=f.y:g.x>=e.x&&g.x<=f.x){s=g.x-h.x;E=g.y-h.y;var m=this.opt.markerSymbol?this.opt.markerSymbol:l.indicator.markerSymbol,
n="M"+s+" "+E+" "+m;r=void 0!=this.opt.markerShadow?this.opt.markerShadow:l.indicator.markerShadow;x=void 0!=this.opt.markerStroke?this.opt.markerStroke:l.indicator.markerStroke;p=void 0!=this.opt.markerOutline?this.opt.markerOutline:l.indicator.markerOutline;r&&v.createPath("M"+(s+r.dx)+" "+(E+r.dy)+" "+m).setFill(r.color).setStroke(r);p&&(p=t.makeStroke(p),p.width=2*p.width+(x?x.width:0),v.createPath(n).setStroke(p));m=v.createPath(n);n=this._shapeFill(void 0!=this.opt.markerFill?this.opt.markerFill:
l.indicator.markerFill,m.getBoundingBox());m.setFill(n).setStroke(x)}return c},this))}B=this.opt.start?{x:m,y:k?n:w}:{x:k?m:A,y:k?w:n};this.opt.labels&&("trend"!=this.opt.labels&&q)&&(this.opt.labelFunc?q=this.opt.labelFunc(c,this.opt.values,this._data,this.opt.fixed,this.opt.precision,this.opt.labels):"markers"==this.opt.labels?(q=F.map(z,function(a){return t.getLabel(a,this.opt.fixed,this.opt.precision)},this),q=1!=q.length?"[ "+q.join(", ")+" ]":q[0]):q=t.getLabel(b,this.opt.fixed,this.opt.precision),
this._renderText(v,q,l,B.x,B.y,c,this.opt.values,this._data));y&&this._connectEvents({element:"indicator",run:this.run?this.run[c]:void 0,shape:v,value:b});D&&this._animateIndicator(v,k,k?n:m,k?n+w:m+A,D);return u.mixin(B,{x1:m,y1:n,x2:A,y2:w})},_animateIndicator:function(b,c,d,a,e){K.animateTransform(u.delegate({shape:b,duration:1200,transform:[{name:"translate",start:c?[0,d]:[d,0],end:[0,0]},{name:"scale",start:c?[1,1/a]:[1/a,1],end:[1,1]},{name:"original"}]},e)).play()},clear:function(){this.inherited(arguments);
this._data=[]},addSeries:function(b){this.inherited(arguments);this._data.push(b.data)},_renderText:function(b,c,d,a,e,f,s,u){this.opt.offset&&(a+=this.opt.offset.x,e+=this.opt.offset.y);c=J.createText.gfx(this.chart,b,a,e,"middle",c,this.opt.font?this.opt.font:d.indicator.font,this.opt.fontColor?this.opt.fontColor:d.indicator.fontColor);a=L(c,c.getShape().text);a.x-=2;a.y-=1;a.width+=4;a.height+=2;a.r=this.opt.radius?this.opt.radius:d.indicator.radius;var l=void 0!=this.opt.shadow?this.opt.shadow:
d.indicator.shadow;e=void 0!=this.opt.stroke?this.opt.stroke:d.indicator.stroke;var h=void 0!=this.opt.outline?this.opt.outline:d.indicator.outline;l&&b.createRect(a).setFill(l.color).setStroke(l);h&&(h=t.makeStroke(h),h.width=2*h.width+(e?e.width:0),b.createRect(a).setStroke(h));d=this.opt.fillFunc?this.opt.fillFunc(f,s,u):void 0!=this.opt.fill?this.opt.fill:d.indicator.fill;b.createRect(a).setFill(this._shapeFill(d,a)).setStroke(e);c.moveToFront()},getSeriesStats:function(){return u.delegate(t.defaultStats)}});
G("dojo-bidi")&&y.extend({_getMarkX:function(b){return this.chart.isRightToLeft()?this.chart.axes.x.scaler.bounds.to+this.chart.axes.x.scaler.bounds.from-b:b}});return y});
//@ sourceMappingURL=Indicator.js.map