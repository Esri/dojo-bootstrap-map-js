//>>built
define("dojox/charting/plot2d/Bars","dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/has ./CartesianBase ./_PlotEvents ./common dojox/gfx/fx dojox/lang/utils dojox/lang/functional dojox/lang/functional/reversed".split(" "),function(r,A,y,E,F,G,s,H,t,I,J){var K=J.lambda("item.purgeGroup()");return y("dojox.charting.plot2d.Bars",[F,G],{defaultParams:{gap:0,animate:null,enableCache:!1},optionalParams:{minBarSize:1,maxBarSize:1,stroke:{},outline:{},shadow:{},fill:{},filter:{},styleFunc:null,
font:"",fontColor:""},constructor:function(a,b){this.opt=r.clone(r.mixin(this.opt,this.defaultParams));t.updateWithObject(this.opt,b);t.updateWithPattern(this.opt,b,this.optionalParams);this.animate=this.opt.animate},getSeriesStats:function(){var a=s.collectSimpleStats(this.series),b;a.hmin-=0.5;a.hmax+=0.5;b=a.hmin;a.hmin=a.vmin;a.vmin=b;b=a.hmax;a.hmax=a.vmax;a.vmax=b;return a},createRect:function(a,b,d){var e;this.opt.enableCache&&0<a._rectFreePool.length?(e=a._rectFreePool.pop(),e.setShape(d),
b.add(e)):e=b.createRect(d);this.opt.enableCache&&a._rectUsePool.push(e);return e},createLabel:function(a,b,d,e){this.opt.labels&&"outside"==this.opt.labelStyle?this.renderLabel(a,d.x+d.width+this.opt.labelOffset,d.y+d.height/2,this._getLabel(isNaN(b.y)?b:b.y),e,"start"):this.inherited(arguments)},render:function(a,b){if(this.zoom&&!this.isDataDirty())return this.performZoom(a,b);this.dirty=this.isDirty();this.resetEvents();var d;this.dirty&&(A.forEach(this.series,K),this._eventSeries={},this.cleanGroup(),
d=this.getGroup(),I.forEachRev(this.series,function(a){a.cleanGroup(d)}));for(var e=this.chart.theme,u=this._hScaler.scaler.getTransformerFromModel(this._hScaler),s=this._vScaler.scaler.getTransformerFromModel(this._vScaler),z=Math.max(0,this._hScaler.bounds.lower),v=u(z),t=this.events(),w=this.getBarProperties(),p=this.series.length-1;0<=p;--p){var c=this.series[p];if(!this.dirty&&!c.dirty)e.skip(),this._reconnectEvents(c.name);else{c.cleanGroup();this.opt.enableCache&&(c._rectFreePool=(c._rectFreePool?
c._rectFreePool:[]).concat(c._rectUsePool?c._rectUsePool:[]),c._rectUsePool=[]);var B=e.next("bar",[this.opt,c]),C=Array(c.data.length);d=c.group;for(var q=A.some(c.data,function(a){return"number"==typeof a||a&&!a.hasOwnProperty("x")}),h=q?Math.max(0,Math.floor(this._vScaler.bounds.from-1)):0,y=q?Math.min(c.data.length,Math.ceil(this._vScaler.bounds.to)):c.data.length;h<y;++h){var n=c.data[h];if(null!=n){var l=this.getValue(n,h,p,q),g=u(l.y),x=Math.abs(g-v),f,m;this.opt.styleFunc||"number"!=typeof n?
(f="number"!=typeof n?[n]:[],this.opt.styleFunc&&f.push(this.opt.styleFunc(n)),f=e.addMixin(B,"bar",f,!0)):f=e.post(B,"bar");if(0<=x&&1<=w.height){g={x:b.l+(l.y<z?g:v),y:a.height-b.b-s(l.x+1.5)+w.gap+w.thickness*(this.series.length-p-1),width:x,height:w.height};f.series.shadow&&(m=r.clone(g),m.x+=f.series.shadow.dx,m.y+=f.series.shadow.dy,m=this.createRect(c,d,m).setFill(f.series.shadow.color).setStroke(f.series.shadow),this.animate&&this._animateBar(m,b.l+v,-x));var k=this._plotFill(f.series.fill,
a,b),k=this._shapeFill(k,g),k=this.createRect(c,d,g).setFill(k).setStroke(f.series.stroke);k.setFilter&&f.series.filter&&k.setFilter(f.series.filter);c.dyn.fill=k.getFill();c.dyn.stroke=k.getStroke();if(t){var D={element:"bar",index:h,run:c,shape:k,shadow:m,cx:l.y,cy:l.x+1.5,x:q?h:c.data[h].x,y:q?c.data[h]:c.data[h].y};this._connectEvents(D);C[h]=D}!isNaN(l.py)&&l.py>z&&(g.x+=u(l.py),g.width-=u(l.py));this.createLabel(d,n,g,f);this.animate&&this._animateBar(k,b.l+v,-x)}}}this._eventSeries[c.name]=
C;c.dirty=!1}}this.dirty=!1;E("dojo-bidi")&&this._checkOrientation(this.group,a,b);return this},getValue:function(a,b,d,e){e?(d="number"==typeof a?a:a.y,a=b):(d=a.y,a=a.x-1);return{y:d,x:a}},getBarProperties:function(){var a=s.calculateBarSize(this._vScaler.bounds.scale,this.opt);return{gap:a.gap,height:a.size,thickness:0}},_animateBar:function(a,b,d){0==d&&(d=1);H.animateTransform(r.delegate({shape:a,duration:1200,transform:[{name:"translate",start:[b-b/d,0],end:[0,0]},{name:"scale",start:[1/d,1],
end:[1,1]},{name:"original"}]},this.animate)).play()}})});
//@ sourceMappingURL=Bars.js.map