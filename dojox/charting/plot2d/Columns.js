//>>built
define("dojox/charting/plot2d/Columns","dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/has ./CartesianBase ./_PlotEvents ./common dojox/lang/functional dojox/lang/functional/reversed dojox/lang/utils dojox/gfx/fx".split(" "),function(r,B,x,F,G,H,s,I,J,t,K){var L=J.lambda("item.purgeGroup()");return x("dojox.charting.plot2d.Columns",[G,H],{defaultParams:{gap:0,animate:null,enableCache:!1},optionalParams:{minBarSize:1,maxBarSize:1,stroke:{},outline:{},shadow:{},fill:{},filter:{},styleFunc:null,
font:"",fontColor:""},constructor:function(a,c){this.opt=r.clone(r.mixin(this.opt,this.defaultParams));t.updateWithObject(this.opt,c);t.updateWithPattern(this.opt,c,this.optionalParams);this.animate=this.opt.animate},getSeriesStats:function(){var a=s.collectSimpleStats(this.series);a.hmin-=0.5;a.hmax+=0.5;return a},createRect:function(a,c,d){var f;this.opt.enableCache&&0<a._rectFreePool.length?(f=a._rectFreePool.pop(),f.setShape(d),c.add(f)):f=c.createRect(d);this.opt.enableCache&&a._rectUsePool.push(f);
return f},render:function(a,c){if(this.zoom&&!this.isDataDirty())return this.performZoom(a,c);this.resetEvents();this.dirty=this.isDirty();var d;this.dirty&&(B.forEach(this.series,L),this._eventSeries={},this.cleanGroup(),d=this.getGroup(),I.forEachRev(this.series,function(a){a.cleanGroup(d)}));for(var f=this.chart.theme,s=this._hScaler.scaler.getTransformerFromModel(this._hScaler),y=this._vScaler.scaler.getTransformerFromModel(this._vScaler),z=Math.max(0,this._vScaler.bounds.lower),u=y(z),t=this.events(),
v=this.getBarProperties(),n=this.series.length-1;0<=n;--n){var b=this.series[n];if(!this.dirty&&!b.dirty)f.skip(),this._reconnectEvents(b.name);else{b.cleanGroup();this.opt.enableCache&&(b._rectFreePool=(b._rectFreePool?b._rectFreePool:[]).concat(b._rectUsePool?b._rectUsePool:[]),b._rectUsePool=[]);var C=f.next("column",[this.opt,b]),D=Array(b.data.length);d=b.group;for(var p=B.some(b.data,function(a){return"number"==typeof a||a&&!a.hasOwnProperty("x")}),g=p?Math.max(0,Math.floor(this._hScaler.bounds.from-
1)):0,x=p?Math.min(b.data.length,Math.ceil(this._hScaler.bounds.to)):b.data.length;g<x;++g){var m=b.data[g];if(null!=m){var l=this.getValue(m,g,n,p),A=y(l.y),w=Math.abs(A-u),e,k;this.opt.styleFunc||"number"!=typeof m?(e="number"!=typeof m?[m]:[],this.opt.styleFunc&&e.push(this.opt.styleFunc(m)),e=f.addMixin(C,"column",e,!0)):e=f.post(C,"column");if(1<=v.width&&0<=w){var q={x:c.l+s(l.x+0.5)+v.gap+v.thickness*n,y:a.height-c.b-(l.y>z?A:u),width:v.width,height:w};e.series.shadow&&(k=r.clone(q),k.x+=e.series.shadow.dx,
k.y+=e.series.shadow.dy,k=this.createRect(b,d,k).setFill(e.series.shadow.color).setStroke(e.series.shadow),this.animate&&this._animateColumn(k,a.height-c.b+u,w));var h=this._plotFill(e.series.fill,a,c),h=this._shapeFill(h,q),h=this.createRect(b,d,q).setFill(h).setStroke(e.series.stroke);h.setFilter&&e.series.filter&&h.setFilter(e.series.filter);b.dyn.fill=h.getFill();b.dyn.stroke=h.getStroke();if(t){var E={element:"column",index:g,run:b,shape:h,shadow:k,cx:l.x+0.5,cy:l.y,x:p?g:b.data[g].x,y:p?b.data[g]:
b.data[g].y};this._connectEvents(E);D[g]=E}!isNaN(l.py)&&l.py>z&&(q.height=A-y(l.py));this.createLabel(d,m,q,e);this.animate&&this._animateColumn(h,a.height-c.b-u,w)}}}this._eventSeries[b.name]=D;b.dirty=!1}}this.dirty=!1;F("dojo-bidi")&&this._checkOrientation(this.group,a,c);return this},getValue:function(a,c,d,f){f?(d="number"==typeof a?a:a.y,a=c):(d=a.y,a=a.x-1);return{x:a,y:d}},getBarProperties:function(){var a=s.calculateBarSize(this._hScaler.bounds.scale,this.opt);return{gap:a.gap,width:a.size,
thickness:0}},_animateColumn:function(a,c,d){0==d&&(d=1);K.animateTransform(r.delegate({shape:a,duration:1200,transform:[{name:"translate",start:[0,c-c/d],end:[0,0]},{name:"scale",start:[1,1/d],end:[1,1]},{name:"original"}]},this.animate)).play()}})});
//@ sourceMappingURL=Columns.js.map